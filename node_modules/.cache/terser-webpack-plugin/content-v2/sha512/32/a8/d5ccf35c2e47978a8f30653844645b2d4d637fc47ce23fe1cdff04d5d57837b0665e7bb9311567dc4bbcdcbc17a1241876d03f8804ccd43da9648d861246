{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[42],{40:function(e,t,a){\"use strict\";a.d(t,\"b\",function(){return i}),a.d(t,\"a\",function(){return n}),a.d(t,\"g\",function(){return s}),a.d(t,\"e\",function(){return o}),a.d(t,\"h\",function(){return l}),a.d(t,\"f\",function(){return c}),a.d(t,\"i\",function(){return u}),a.d(t,\"c\",function(){return m}),a.d(t,\"d\",function(){return d});var r=a(0);function i(e){return Object(r.a)(\"POST\",\"admin/team\",e)}function n(e,t){return Object(r.a)(\"POST\",`admin/team/${e}/users`,t)}function s(e){return Object(r.a)(\"GET\",`admin/team/${e}`)}function o(e,t){return Object(r.a)(\"PUT\",`admin/team/${e}`,t)}function l(e,t,a){return Object(r.a)(\"GET\",\"admin/teams\",{page:e,perpage:t,param:a})}function c(){return Object(r.a)(\"GET\",\"admin/allteams\")}function u(e,t,a,i){return Object(r.a)(\"GET\",`admin/team/${e}/users`,{page:t,perpage:a,param:i})}function m(e){return Object(r.a)(\"DELETE\",`admin/team/${e}`)}function d(e,t){return Object(r.a)(\"DELETE\",`admin/team/${e}/user/${t}`)}},562:function(e,t,a){\"use strict\";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a(\"div\",{staticClass:\"admin-content\"},[a(\"div\",{staticClass:\"content__breadcrumb\"},[a(\"el-breadcrumb\",{attrs:{separator:\"/\"}},[a(\"el-breadcrumb-item\",{attrs:{to:{name:\"adminIndex\"}}},[e._v(\"首页\")]),a(\"el-breadcrumb-item\",[e._v(e._s(e.$route.meta.title))])],1)],1),a(\"div\",{staticClass:\"content__main\"},[a(\"el-card\",{staticClass:\"content__card__wrapper\"},[a(\"p\",[e._v(\"团队名称: \"+e._s(e.team.name))]),a(\"p\",[e._v(\"成员总数: \"+e._s(e.total))])]),a(\"div\",{staticClass:\"content__button__wrapper\"},[a(\"el-button\",{attrs:{type:\"success\"},on:{click:e.handleAddUser}},[e._v(\"添加成员\")])],1),a(\"div\",{staticClass:\"content__searchbar__wrapper\"},[a(\"el-input\",{staticStyle:{\"max-width\":\"20em\"},attrs:{placeholder:\"请输入用户名或昵称\",maxlength:\"20\",clearable:\"\"},model:{value:e.queryParam,callback:function(t){e.queryParam=t},expression:\"queryParam\"}}),a(\"el-button\",{attrs:{icon:\"el-icon-search\",type:\"primary\",plain:\"\"},on:{click:e.fetchTeamUserList}})],1),a(\"el-table\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:e.loading,expression:\"loading\"}],staticStyle:{width:\"100%\"},attrs:{data:e.tableData}},[a(\"el-table-column\",{attrs:{label:\"ID\",prop:\"id\",width:\"180\"}}),a(\"el-table-column\",{attrs:{label:\"用户名\",prop:\"username\",width:\"180\"}}),a(\"el-table-column\",{attrs:{label:\"昵称\",prop:\"nick\"}}),a(\"el-table-column\",{attrs:{label:\"操作\",width:\"180\"},scopedSlots:e._u([{key:\"default\",fn:function(t){return[a(\"el-button\",{attrs:{size:\"mini\",type:\"danger\"},on:{click:function(a){return e.handleDeleteTeamUser(t.row)}}},[e._v(\"删除\")])]}}])})],1),a(\"el-pagination\",{attrs:{\"current-page\":e.currentPage,\"page-sizes\":[10,20,30,40,50],\"page-size\":10,layout:\"total, sizes, prev, pager, next, jumper\",total:e.total},on:{\"size-change\":e.handleSizeChange,\"current-change\":e.fetchTeamUserList,\"update:currentPage\":function(t){e.currentPage=t},\"update:current-page\":function(t){e.currentPage=t}}}),a(\"el-dialog\",{attrs:{title:\"添加团队成员\",visible:e.dialogFormVisible,width:\"400px\",\"close-on-click-modal\":!1},on:{\"update:visible\":function(t){e.dialogFormVisible=t},closed:e.closeDialog,opened:e.openDialog}},[a(\"el-form\",{ref:\"form\",attrs:{model:e.form,rules:e.rules},nativeOn:{submit:function(e){e.preventDefault()}}},[a(\"el-form-item\",{attrs:{label:\"用户名列表\",prop:\"userList\"}},[a(\"el-input\",{ref:\"input\",attrs:{type:\"textarea\",rows:\"20\",autocomplete:\"off\",resize:\"none\"},model:{value:e.form.userList,callback:function(t){e.$set(e.form,\"userList\",t)},expression:\"form.userList\"}})],1)],1),a(\"div\",{staticClass:\"dialog-footer\",attrs:{slot:\"footer\"},slot:\"footer\"},[a(\"el-button\",{on:{click:e.cancel}},[e._v(\"取消\")]),a(\"el-button\",{attrs:{type:\"primary\",\"native-type\":\"submit\"},on:{click:function(t){return e.submit()}}},[e._v(\"确定\")])],1)],1),a(\"el-dialog\",{attrs:{title:\"操作信息\",visible:e.dialogOperatorInfoVisible,\"close-on-click-modal\":!1,width:\"600px\"},on:{\"update:visible\":function(t){e.dialogOperatorInfoVisible=t}}},[e._l(e.infoList,function(t,r){return[a(\"p\",{key:r},[e._v(e._s(t))])]}),a(\"div\",{staticClass:\"dialog-footer\",attrs:{slot:\"footer\"},slot:\"footer\"},[a(\"el-button\",{on:{click:function(t){e.dialogOperatorInfoVisible=!1}}},[e._v(\"取消\")]),a(\"el-button\",{attrs:{type:\"primary\"},on:{click:function(t){e.dialogOperatorInfoVisible=!1}}},[e._v(\"确定\")])],1)],2)],1)])};r._withStripped=!0;var i=a(40),n={data:()=>({loading:!0,currentPage:1,currentRowId:0,perpage:10,queryParam:\"\",total:0,dialogFormVisible:!1,dialogOperatorInfoVisible:!1,infoList:[],team:{},form:{userList:\"\"},rules:{userList:[{required:!0,message:\"请输入要添加的用户名列表\",trigger:\"blur\"}]},tableData:[]}),async mounted(){let e=this.$route.params.id;try{let t=await Object(i.g)(e);this.team=t.data.team,this.fetchTeamUserList()}catch(e){this.$router.replace({name:\"admin404Page\"}),console.log(e)}},methods:{async fetchTeamUserList(){const e=this;e.loading=!0;try{let t=await Object(i.i)(e.team.id,e.currentPage,e.perpage,e.queryParam);console.log(t);let a=t.data;setTimeout(()=>{e.tableData=a.data,e.total=a.total,e.loading=!1},200)}catch(e){console.log(e)}},handleSizeChange(e){this.perpage=e,console.log(this.perpage),this.fetchTeamUserList()},openDialog(){this.$notify({title:\"提示\",message:\"每一行对应一个用户名，若对应账号存在则加入团队，否则将忽略。\",duration:6e3}),this.$refs.form.clearValidate(),this.$refs.input.focus()},closeDialog(){this.$refs.form.resetFields(),this.$refs.input.blur()},submit(){const e=this;e.$refs.form.validate(async t=>{if(!t)return!1;try{let t,a=e.$route.params.id;t=await Object(i.a)(a,e.form),console.log(t),e.infoList=t.data.info,e.dialogOperatorInfoVisible=!0,e.$message({message:t.data.message,type:\"success\"}),e.fetchTeamUserList()}catch(t){e.$message({message:t.response.data.message,type:\"error\"})}e.dialogFormVisible=!1})},cancel(){this.dialogFormVisible=!1},handleAddUser(){this.dialogFormVisible=!0},async handleDeleteTeamUser(e){const t=this;try{await t.$confirm(`确认要删除团队成员${e.username}吗?`,\"提示\",{confirmButtonText:\"确定\",cancelButtonText:\"取消\",type:\"warning\"});try{let a=await Object(i.d)(t.team.id,e.id);t.$message({type:\"success\",message:a.data.message}),1==t.tableData.length&&t.currentPage>1&&t.currentPage--,t.fetchTeamUserList()}catch(e){t.$message({type:\"error\",message:e.response.data.message})}}catch(e){t.$message({type:\"info\",message:\"已取消删除\"})}}}},s=a(2),o=Object(s.a)(n,r,[],!1,null,\"da1f78c0\",null);o.options.__file=\"web-admin/js/pages/team_manage/index.vue\";t.default=o.exports}}]);","extractedComments":[]}