{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[39],{48:function(e,t,a){\"use strict\";a.d(t,\"b\",function(){return r}),a.d(t,\"d\",function(){return i}),a.d(t,\"e\",function(){return n}),a.d(t,\"g\",function(){return o}),a.d(t,\"f\",function(){return c}),a.d(t,\"h\",function(){return l}),a.d(t,\"a\",function(){return m}),a.d(t,\"c\",function(){return u});var s=a(0);function r(e){return Object(s.a)(\"POST\",\"admin/series\",e)}function i(e,t){return Object(s.a)(\"PUT\",`admin/series/${e}`,t)}function n(e){return Object(s.a)(\"GET\",`admin/series/${e}`)}function o(e,t,a){return Object(s.a)(\"GET\",\"admin/serieses\",{page:e,perpage:t,param:a})}function c(e,t,a,r){return Object(s.a)(\"GET\",`admin/series/${e}/contests`,{page:t,perpage:a,param:r})}function l(e){return Object(s.a)(\"PUT\",`admin/series/${e}/status`)}function m(e,t){return Object(s.a)(\"POST\",`admin/series/${e}/contest/${t}`)}function u(e,t){return Object(s.a)(\"DELETE\",`admin/series/${e}/contest/${t}`)}},572:function(e,t,a){\"use strict\";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a(\"div\",{staticClass:\"admin-content\"},[a(\"div\",{staticClass:\"content__breadcrumb\"},[a(\"el-breadcrumb\",{attrs:{separator:\"/\"}},[a(\"el-breadcrumb-item\",{attrs:{to:{name:\"adminIndex\"}}},[e._v(\"首页\")]),a(\"el-breadcrumb-item\",[e._v(e._s(e.$route.meta.title))])],1)],1),a(\"div\",{staticClass:\"content__main\"},[a(\"div\",{staticClass:\"content__button__wrapper\"},[a(\"el-button\",{attrs:{type:\"success\"},on:{click:e.handleCreateSeries}},[e._v(\"新建系列赛\")])],1),a(\"div\",{staticClass:\"content__searchbar__wrapper\"},[a(\"el-input\",{staticStyle:{\"max-width\":\"20em\"},attrs:{placeholder:\"请输入系列赛名称\",maxlength:\"20\",clearable:\"\"},model:{value:e.queryParam,callback:function(t){e.queryParam=t},expression:\"queryParam\"}}),a(\"el-button\",{attrs:{icon:\"el-icon-search\",type:\"primary\",plain:\"\"},on:{click:e.fetchSeriesList}})],1),a(\"el-table\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:e.loading,expression:\"loading\"}],staticStyle:{width:\"100%\"},attrs:{data:e.tableData}},[a(\"el-table-column\",{attrs:{label:\"ID\",prop:\"id\",width:\"180\"}}),a(\"el-table-column\",{attrs:{label:\"名称\",prop:\"name\",\"min-width\":\"300\"}}),a(\"el-table-column\",{attrs:{label:\"状态\",width:\"240\"},scopedSlots:e._u([{key:\"default\",fn:function(t){return[a(\"span\",{staticClass:\"text-button\",class:[0==t.row.defunct?\"text-button--success\":\"text-button--danger\"]},[e._v(e._s(0==t.row.defunct?\"启用\":\"保留\"))]),a(\"span\",{staticClass:\"text-button\",class:[0==t.row.team_mode?\"text-button--success\":\"text-button--primary\"]},[e._v(e._s(0==t.row.team_mode?\"个人\":\"团队\"))])]}}])}),a(\"el-table-column\",{attrs:{label:\"操作\",width:\"300\"},scopedSlots:e._u([{key:\"default\",fn:function(t){return[a(\"el-button\",{attrs:{size:\"mini\",type:\"primary\"},on:{click:function(a){return e.$router.push({name:\"adminSeriesManage\",params:{id:t.row.id}})}}},[e._v(\"管理\")]),a(\"el-button\",{attrs:{size:\"mini\",type:\"primary\"},on:{click:function(a){return e.handleEditSeries(t.row)}}},[e._v(\"编辑\")]),a(\"el-button\",{attrs:{size:\"mini\",type:0==t.row.defunct?\"danger\":\"success\"},on:{click:function(a){return e.handleToggleSeriesStatus(t.row)}}},[e._v(e._s(0==t.row.defunct?\"保留\":\"启用\"))]),a(\"el-button\",{attrs:{size:\"mini\",type:\"danger\"},on:{click:function(a){return e.handleDeleteContest(t.row)}}},[e._v(\"删除\")])]}}])})],1),a(\"el-pagination\",{attrs:{\"current-page\":e.currentPage,\"page-sizes\":[10,20,30,40,50],\"page-size\":10,layout:\"total, sizes, prev, pager, next, jumper\",total:e.total},on:{\"size-change\":e.handleSizeChange,\"current-change\":e.fetchSeriesList,\"update:currentPage\":function(t){e.currentPage=t},\"update:current-page\":function(t){e.currentPage=t}}})],1),a(\"el-dialog\",{attrs:{title:e.dialogFormTitle,visible:e.dialogFormVisible,width:\"600px\",\"close-on-click-modal\":!1},on:{\"update:visible\":function(t){e.dialogFormVisible=t},closed:e.closeDialog,opened:e.openDialog}},[a(\"el-form\",{ref:\"form\",attrs:{model:e.form,rules:e.rules},nativeOn:{submit:function(e){e.preventDefault()}}},[a(\"el-form-item\",{attrs:{label:\"系列赛名称\",prop:\"name\"}},[a(\"el-input\",{ref:\"input\",attrs:{autocomplete:\"off\"},model:{value:e.form.name,callback:function(t){e.$set(e.form,\"name\",t)},expression:\"form.name\"}})],1),a(\"el-form-item\",{attrs:{label:\"系列赛模式\",prop:\"team_mode\"}},[a(\"el-switch\",{attrs:{\"active-text\":\"团队\",\"inactive-text\":\"个人\",\"inactive-color\":\"#99cc33\",\"active-value\":1,\"inactive-value\":0},model:{value:e.form.team_mode,callback:function(t){e.$set(e.form,\"team_mode\",t)},expression:\"form.team_mode\"}})],1),a(\"el-form-item\",{attrs:{label:\"系列赛描述\",prop:\"description\"}},[a(\"el-input\",{attrs:{type:\"textarea\",rows:5,autocomplete:\"off\"},model:{value:e.form.description,callback:function(t){e.$set(e.form,\"description\",t)},expression:\"form.description\"}})],1)],1),a(\"div\",{staticClass:\"dialog-footer\",attrs:{slot:\"footer\"},slot:\"footer\"},[a(\"el-button\",{on:{click:e.cancel}},[e._v(\"取消\")]),a(\"el-button\",{attrs:{type:\"primary\",\"native-type\":\"submit\"},on:{click:e.submit}},[e._v(\"确定\")])],1)],1)],1)};s._withStripped=!0;var r=a(48),i={data:()=>({loading:!0,currentPage:1,currentRowId:0,perpage:10,queryParam:\"\",total:0,dialogFormTitle:\"\",dialogFormVisible:!1,submitMode:\"\",form:{name:\"\",team_mode:0,description:\"\"},rules:{name:[{required:!0,message:\"请输入系列赛名称\",trigger:\"blur\"},{max:20,message:\"超出长度限制\",trigger:\"blur\"}]},tableData:[]}),mounted(){this.fetchSeriesList()},methods:{async fetchSeriesList(){const e=this;e.loading=!0;try{let t=(await Object(r.g)(e.currentPage,e.perpage,e.queryParam)).data;setTimeout(()=>{e.tableData=t.data,e.total=t.total,e.loading=!1},200)}catch(e){console.log(e)}},handleSizeChange(e){this.perpage=e,console.log(this.perpage),this.fetchSeriesList()},openDialog(){this.$notify({title:\"提示\",message:\"系列赛中只会显示与系列赛模式相同的比赛数据！\",duration:6e3}),this.$refs.form.clearValidate(),this.$refs.input.focus()},closeDialog(){this.$refs.form.resetFields(),this.$refs.input.blur(),this.form.name=\"\",this.form.description=\"\",this.form.team_mode=0},submit(){const e=this;e.$refs.form.validate(async t=>{if(!t)return!1;try{let t;t=\"create\"==e.submitMode?await Object(r.b)(e.form):await Object(r.d)(e.currentRowId,e.form),e.$message({message:t.data.message,type:\"success\"}),e.fetchSeriesList()}catch(t){e.$message({message:t.response.data.message,type:\"error\"})}e.dialogFormVisible=!1})},cancel(){this.dialogFormVisible=!1},handleCreateSeries(){this.dialogFormTitle=\"新建系列赛\",this.submitMode=\"create\",this.dialogFormVisible=!0},handleEditSeries(e){this.dialogFormTitle=\"编辑系列赛\",this.submitMode=\"edit\",this.currentRowId=e.id,this.form.name=e.name,this.form.description=e.description,this.form.team_mode=e.team_mode,this.dialogFormVisible=!0},async handleToggleSeriesStatus(e){const t=this;let a=`确认要${0==e.defunct?\"保留\":\"启用\"}系列赛${e.name}吗?`;try{await t.$confirm(a,\"提示\",{confirmButtonText:\"确定\",cancelButtonText:\"取消\",type:\"warning\"});try{let a=await Object(r.h)(e.id);t.$message({type:\"success\",message:a.data.message}),e.defunct=!e.defunct}catch(e){t.$message({type:\"error\",message:e.response.data.message})}}catch(e){t.$message({type:\"info\",message:\"已取消操作\"})}},async handleDeleteContest(e){const t=this;try{await t.$confirm(`确认要删除问题${e.name}吗?`,\"提示\",{confirmButtonText:\"确定\",cancelButtonText:\"取消\",type:\"warning\"});try{let a=await deleteContest(e.id);t.$message({type:\"success\",message:a.data.message}),t.fetchContestList()}catch(e){t.$message({type:\"error\",message:e.response.data.message})}}catch(e){t.$message({type:\"info\",message:\"已取消删除\"})}}}},n=a(2),o=Object(n.a)(i,s,[],!1,null,\"5c26b0bf\",null);o.options.__file=\"web-admin/js/pages/series_list/index.vue\";t.default=o.exports}}]);","extractedComments":[]}