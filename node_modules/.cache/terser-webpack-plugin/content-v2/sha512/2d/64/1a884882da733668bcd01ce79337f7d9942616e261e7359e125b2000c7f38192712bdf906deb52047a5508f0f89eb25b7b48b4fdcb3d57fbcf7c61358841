{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{13:function(e,t,a){\"use strict\";a.d(t,\"e\",function(){return s}),a.d(t,\"j\",function(){return r}),a.d(t,\"l\",function(){return o}),a.d(t,\"m\",function(){return i}),a.d(t,\"k\",function(){return c}),a.d(t,\"f\",function(){return d}),a.d(t,\"p\",function(){return l}),a.d(t,\"o\",function(){return m}),a.d(t,\"d\",function(){return u}),a.d(t,\"i\",function(){return f}),a.d(t,\"n\",function(){return p}),a.d(t,\"a\",function(){return g}),a.d(t,\"g\",function(){return b}),a.d(t,\"c\",function(){return T}),a.d(t,\"b\",function(){return h}),a.d(t,\"h\",function(){return $});var n=a(0);function s(e){return Object(n.a)(\"POST\",\"admin/contest\",e)}function r(e,t){return console.log(e,t),Object(n.a)(\"PUT\",`admin/contest/${e}`,t)}function o(e){return Object(n.a)(\"GET\",`admin/contest/${e}`)}function i(e,t,a){return Object(n.a)(\"GET\",\"admin/contests\",{page:e,perpage:t,param:a})}function c(){return Object(n.a)(\"GET\",\"admin/allcontests\")}function d(e){return Object(n.a)(\"DELETE\",`admin/contest/${e}`)}function l(e){return Object(n.a)(\"PUT\",`admin/contest/${e}/status`)}function m(e,t,a,s){return Object(n.a)(\"GET\",`admin/contest/${e}/users`,{page:t,perpage:a,param:s})}function u(e,t){return Object(n.a)(\"POST\",`admin/contest/${e}/users`,t)}function f(e,t){return Object(n.a)(\"DELETE\",`admin/contest/${e}/user/${t}`)}function p(e){return Object(n.a)(\"GET\",`admin/contest/${e}/teams`)}function g(e,t){return Object(n.a)(\"POST\",`admin/contest/${e}/team/${t}`)}function b(e,t){return Object(n.a)(\"DELETE\",`admin/contest/${e}/team/${t}`)}function T(e,t,a){return Object(n.a)(\"POST\",`admin/contest/${e}/team/${t}/users`,a)}function h(e,t){return Object(n.a)(\"POST\",`admin/contest/${e}/team/${t}/allusers`)}function $(e,t,a){return Object(n.a)(\"DELETE\",`admin/contest/${e}/team/${t}/user/${a}`)}},40:function(e,t,a){\"use strict\";a.d(t,\"b\",function(){return s}),a.d(t,\"a\",function(){return r}),a.d(t,\"g\",function(){return o}),a.d(t,\"e\",function(){return i}),a.d(t,\"h\",function(){return c}),a.d(t,\"f\",function(){return d}),a.d(t,\"i\",function(){return l}),a.d(t,\"c\",function(){return m}),a.d(t,\"d\",function(){return u});var n=a(0);function s(e){return Object(n.a)(\"POST\",\"admin/team\",e)}function r(e,t){return Object(n.a)(\"POST\",`admin/team/${e}/users`,t)}function o(e){return Object(n.a)(\"GET\",`admin/team/${e}`)}function i(e,t){return Object(n.a)(\"PUT\",`admin/team/${e}`,t)}function c(e,t,a){return Object(n.a)(\"GET\",\"admin/teams\",{page:e,perpage:t,param:a})}function d(){return Object(n.a)(\"GET\",\"admin/allteams\")}function l(e,t,a,s){return Object(n.a)(\"GET\",`admin/team/${e}/users`,{page:t,perpage:a,param:s})}function m(e){return Object(n.a)(\"DELETE\",`admin/team/${e}`)}function u(e,t){return Object(n.a)(\"DELETE\",`admin/team/${e}/user/${t}`)}},570:function(e,t,a){\"use strict\";a.r(t);var n=a(13),s=a(40),r={data:()=>({dialogAddTeamFormVisible:!1,dialogAddTeamUserFormVisible:!1,dialogOperatorInfoVisible:!1,contest:{},teams:[],currentTeam:{},activeNames:[],contestTeamList:[],infoList:[],addTeamForm:{team_id:null},addTeamUserForm:{userList:\"\"},addTeamFormRules:{team_id:[{required:!0,message:\"请选择要添加的团队\",trigger:\"change\"}]},addTeamUserFormRules:{userList:[{required:!0,message:\"请输入要添加的用户名列表\",trigger:\"blur\"}]},tableData:[]}),async mounted(){let e=this.$route.params.id;try{let t=await Object(n.l)(e);this.contest=t.data.contest,t=await Object(s.f)(),this.teams=t.data.teams,this.fetchContestTeamList()}catch(e){this.$router.replace({name:\"admin404Page\"}),console.log(e)}},methods:{async fetchContestTeamList(){const e=this;e.loading=!0;try{let t=await Object(n.n)(e.contest.id);e.contestTeamList=t.data.data,e.contestTeamList.forEach((t,a)=>{e.activeNames.push(t.name)})}catch(e){console.log(e)}},openAddTeamDialog(){this.$refs.addTeamForm.clearValidate()},closeAddTeamDialog(){this.$refs.addTeamForm.resetFields()},openAddTeamUserDialog(){this.$notify({title:\"提示\",message:\"每一行对应一个用户名，若对应账号属于该团队并且没有以其他团队成员参与该竞赛则加入，否则将忽略。\",duration:6e3}),this.$refs.addTeamUserForm.clearValidate()},closeAddTeamUserDialog(){this.$refs.addTeamUserForm.resetFields()},submitAddTeam(){const e=this;e.$refs.addTeamForm.validate(async t=>{if(!t)return!1;try{let t,a=e.$route.params.id;t=await Object(n.a)(a,e.addTeamForm.team_id),e.$message({message:t.data.message,type:\"success\"}),e.fetchContestTeamList()}catch(t){console.log(t),e.$message({message:t.response.data.message,type:\"error\"})}e.dialogAddTeamFormVisible=!1})},submitAddTeamUsers(){const e=this;e.$refs.addTeamUserForm.validate(async t=>{if(!t)return!1;try{let t,a=e.$route.params.id;t=await Object(n.c)(a,e.currentTeam.id,e.addTeamUserForm),console.log(t),e.infoList=t.data.info,e.dialogOperatorInfoVisible=!0,e.$message({message:t.data.message,type:\"success\"}),e.fetchContestTeamList()}catch(t){console.log(t),e.$message({message:t.response.data.message,type:\"error\"})}e.dialogAddTeamUserFormVisible=!1})},cancelDialogAddTeam(){this.dialogAddTeamFormVisible=!1},cancelDialogAddTeamUser(){this.dialogAddTeamUserFormVisible=!1},handleAddUser(){this.dialogAddTeamFormVisible=!0},handleAddContestTeamUsers(e){this.currentTeam=e,this.dialogAddTeamUserFormVisible=!0},async handleAddContestTeamAllUsers(e){const t=this;try{await t.$confirm(`确认要添加团队${e.name}的全部成员吗?`,\"提示\",{confirmButtonText:\"确定\",cancelButtonText:\"取消\",type:\"warning\"});try{let a=await Object(n.b)(t.contest.id,e.id);t.infoList=a.data.info,t.dialogOperatorInfoVisible=!0,t.$message({type:\"success\",message:a.data.message}),t.fetchContestTeamList()}catch(e){console.log(e),t.$message({type:\"error\",message:e.response.data.message})}}catch(e){console.log(e),t.$message({type:\"info\",message:\"已取消删除\"})}},async handleDeleteContestTeam(e){const t=this;try{await t.$confirm(`确认要删除团队${e.name}吗?`,\"提示\",{confirmButtonText:\"确定\",cancelButtonText:\"取消\",type:\"warning\"});try{let a=await Object(n.g)(t.contest.id,e.id);t.$message({type:\"success\",message:a.data.message}),t.fetchContestTeamList()}catch(e){console.log(e),t.$message({type:\"error\",message:e.response.data.message})}}catch(e){console.log(e),t.$message({type:\"info\",message:\"已取消删除\"})}},async handleDeleteContestTeamUser(e,t){const a=this;try{await a.$confirm(`确认要删除团队${e.name}中成员${t.username}吗?`,\"提示\",{confirmButtonText:\"确定\",cancelButtonText:\"取消\",type:\"warning\"});try{let s=await Object(n.h)(a.contest.id,e.id,t.id);a.$message({type:\"success\",message:s.data.message}),a.fetchContestTeamList()}catch(e){console.log(e),a.$message({type:\"error\",message:e.response.data.message})}}catch(e){console.log(e),a.$message({type:\"info\",message:\"已取消删除\"})}}}},o=a(2),i=Object(o.a)(r,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a(\"div\",{staticClass:\"admin-content\"},[a(\"div\",{staticClass:\"content__breadcrumb\"},[a(\"el-breadcrumb\",{attrs:{separator:\"/\"}},[a(\"el-breadcrumb-item\",{attrs:{to:{name:\"adminIndex\"}}},[e._v(\"首页\")]),a(\"el-breadcrumb-item\",[e._v(e._s(e.$route.meta.title))])],1)],1),a(\"div\",{staticClass:\"content__main\"},[a(\"el-card\",{staticClass:\"content__card__wrapper\"},[a(\"p\",[e._v(\"竞赛&作业名称: \"+e._s(e.contest.name))]),a(\"p\",[e._v(\"包含团队总数: \"+e._s(e.contestTeamList.length))])]),a(\"div\",{staticClass:\"content__button__wrapper\"},[a(\"el-button\",{attrs:{type:\"success\"},on:{click:e.handleAddUser}},[e._v(\"添加团队\")])],1),a(\"el-card\",[a(\"el-collapse\",{model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:\"activeNames\"}},[e._l(e.contestTeamList,function(t,n){return[a(\"el-collapse-item\",{attrs:{title:t.name,name:t.name}},[a(\"div\",{staticClass:\"content__button__wrapper\"},[a(\"el-button\",{attrs:{type:\"success\",size:\"small\"},on:{click:function(a){return e.handleAddContestTeamUsers(t)}}},[e._v(\"添加成员\")]),a(\"el-button\",{attrs:{type:\"primary\",size:\"small\"},on:{click:function(a){return e.handleAddContestTeamAllUsers(t)}}},[e._v(\"添加全部成员\")]),a(\"el-button\",{attrs:{type:\"danger\",size:\"small\"},on:{click:function(a){return e.handleDeleteContestTeam(t)}}},[e._v(\"删除团队\")])],1),a(\"el-table\",{staticStyle:{width:\"100%\"},attrs:{data:t.userinfos}},[a(\"el-table-column\",{attrs:{label:\"ID\",prop:\"id\",width:\"180\"}}),a(\"el-table-column\",{attrs:{label:\"用户名\",prop:\"username\",width:\"180\"}}),a(\"el-table-column\",{attrs:{label:\"昵称\",prop:\"nick\"}}),a(\"el-table-column\",{attrs:{label:\"操作\",width:\"180\"},scopedSlots:e._u([{key:\"default\",fn:function(n){return[a(\"el-button\",{attrs:{size:\"mini\",type:\"danger\"},on:{click:function(a){return e.handleDeleteContestTeamUser(t,n.row)}}},[e._v(\"删除\")])]}}],null,!0)})],1)],1)]})],2)],1),a(\"el-dialog\",{attrs:{title:\"添加团队\",visible:e.dialogAddTeamFormVisible,width:\"400px\",\"close-on-click-modal\":!1},on:{\"update:visible\":function(t){e.dialogAddTeamFormVisible=t},closed:e.closeAddTeamDialog,opened:e.openAddTeamDialog}},[a(\"el-form\",{ref:\"addTeamForm\",attrs:{model:e.addTeamForm,rules:e.addTeamFormRules},nativeOn:{submit:function(e){e.preventDefault()}}},[a(\"el-form-item\",{attrs:{label:\"选择团队\",prop:\"team_id\"}},[a(\"el-select\",{attrs:{filterable:\"\",placeholder:\"请选择\"},model:{value:e.addTeamForm.team_id,callback:function(t){e.$set(e.addTeamForm,\"team_id\",t)},expression:\"addTeamForm.team_id\"}},e._l(e.teams,function(e){return a(\"el-option\",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1)],1),a(\"div\",{staticClass:\"dialog-footer\",attrs:{slot:\"footer\"},slot:\"footer\"},[a(\"el-button\",{on:{click:e.cancelDialogAddTeam}},[e._v(\"取消\")]),a(\"el-button\",{attrs:{type:\"primary\",\"native-type\":\"submit\"},on:{click:e.submitAddTeam}},[e._v(\"确定\")])],1)],1),a(\"el-dialog\",{attrs:{title:\"添加团队成员\",visible:e.dialogAddTeamUserFormVisible,width:\"400px\",\"close-on-click-modal\":!1},on:{\"update:visible\":function(t){e.dialogAddTeamUserFormVisible=t},closed:e.closeAddTeamUserDialog,opened:e.openAddTeamUserDialog}},[a(\"el-form\",{ref:\"addTeamUserForm\",attrs:{model:e.addTeamUserForm,rules:e.addTeamUserFormRules},nativeOn:{submit:function(e){e.preventDefault()}}},[a(\"el-form-item\",{attrs:{label:\"用户名列表\",prop:\"userList\"}},[a(\"el-input\",{ref:\"input\",attrs:{type:\"textarea\",rows:\"20\",autocomplete:\"off\",resize:\"none\"},model:{value:e.addTeamUserForm.userList,callback:function(t){e.$set(e.addTeamUserForm,\"userList\",t)},expression:\"addTeamUserForm.userList\"}})],1)],1),a(\"div\",{staticClass:\"dialog-footer\",attrs:{slot:\"footer\"},slot:\"footer\"},[a(\"el-button\",{on:{click:e.cancelDialogAddTeamUser}},[e._v(\"取消\")]),a(\"el-button\",{attrs:{type:\"primary\",\"native-type\":\"submit\"},on:{click:e.submitAddTeamUsers}},[e._v(\"确定\")])],1)],1),a(\"el-dialog\",{attrs:{title:\"操作信息\",visible:e.dialogOperatorInfoVisible,\"close-on-click-modal\":!1,width:\"600px\"},on:{\"update:visible\":function(t){e.dialogOperatorInfoVisible=t}}},[e._l(e.infoList,function(t,n){return[a(\"p\",{key:n},[e._v(e._s(t))])]}),a(\"div\",{staticClass:\"dialog-footer\",attrs:{slot:\"footer\"},slot:\"footer\"},[a(\"el-button\",{on:{click:function(t){e.dialogOperatorInfoVisible=!1}}},[e._v(\"取消\")]),a(\"el-button\",{attrs:{type:\"primary\"},on:{click:function(t){e.dialogOperatorInfoVisible=!1}}},[e._v(\"确定\")])],1)],2)],1)])},[],!1,null,\"5c34811d\",null);t.default=i.exports}}]);","extractedComments":[]}