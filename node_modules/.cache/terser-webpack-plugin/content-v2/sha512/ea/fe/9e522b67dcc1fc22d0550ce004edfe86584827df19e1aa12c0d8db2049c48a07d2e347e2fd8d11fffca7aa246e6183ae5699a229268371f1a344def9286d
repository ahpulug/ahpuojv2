{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[36],{560:function(e,t,a){\"use strict\";a.r(t);var n=a(57),s={data:()=>({loading:!0,currentPage:1,currentRowId:0,perpage:10,total:0,queryParam:\"\",submitMode:\"\",form:{title:\"\"},rules:{title:[{required:!0,message:\"请输入新闻名称\",trigger:\"blur\"},{max:20,message:\"超出长度限制\",trigger:\"blur\"}]},tableData:[]}),mounted(){this.fetchNewList()},methods:{async fetchNewList(){const e=this;e.loading=!0;try{let t=(await Object(n.e)(e.currentPage,e.perpage,e.queryParam)).data;setTimeout(()=>{e.tableData=t.data,e.total=t.total,e.loading=!1},200)}catch(e){console.log(e)}},handleSizeChange(e){this.perpage=e,this.fetchNewList()},async handleDeleteNew(e){const t=this;try{await t.$confirm(`确认要删除新闻${e.title}吗?`,\"提示\",{confirmButtonText:\"确定\",cancelButtonText:\"取消\",type:\"warning\"});try{let a=await Object(n.b)(e.id);t.$message({type:\"success\",message:a.data.message}),1==t.tableData.length&&t.currentPage>1&&t.currentPage--,t.fetchNewList()}catch(e){t.$message({type:\"error\",message:e.response.data.message})}}catch(e){t.$message({type:\"info\",message:\"已取消删除\"})}},async handleToggleNewStatus(e){const t=this;let a=`确认要${0==e.defunct?\"隐藏\":\"显示\"}新闻${e.title}吗?`;try{await t.$confirm(a,\"提示\",{confirmButtonText:\"确定\",cancelButtonText:\"取消\",type:\"warning\"});try{let a=await Object(n.f)(e.id);t.$message({type:\"success\",message:a.data.message}),e.defunct=!e.defunct}catch(e){t.$message({type:\"error\",message:e.response.data.message})}}catch(e){t.$message({type:\"info\",message:\"已取消操作\"})}},async handleToggleNewTopStatus(e){const t=this;let a=`确认要${0==e.top?\"置顶\":\"取置\"}新闻${e.title}吗?`;try{await t.$confirm(a,\"提示\",{confirmButtonText:\"确定\",cancelButtonText:\"取消\",type:\"warning\"});try{let a=await Object(n.g)(e.id);t.$message({type:\"success\",message:a.data.message}),t.fetchNewList()}catch(e){t.$message({type:\"error\",message:e.response.data.message})}}catch(e){t.$message({type:\"info\",message:\"已取消操作\"})}}}},r=a(2),c=Object(r.a)(s,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a(\"div\",{staticClass:\"admin-content\"},[a(\"div\",{staticClass:\"content__breadcrumb\"},[a(\"el-breadcrumb\",{attrs:{separator:\"/\"}},[a(\"el-breadcrumb-item\",{attrs:{to:{name:\"adminIndex\"}}},[e._v(\"首页\")]),a(\"el-breadcrumb-item\",[e._v(e._s(e.$route.meta.title))])],1)],1),a(\"div\",{staticClass:\"content__main\"},[a(\"div\",{staticClass:\"content__searchbar__wrapper\"},[a(\"el-input\",{staticStyle:{\"max-width\":\"20em\"},attrs:{placeholder:\"请输入新闻名称\",maxlength:\"20\",clearable:\"\"},model:{value:e.queryParam,callback:function(t){e.queryParam=t},expression:\"queryParam\"}}),a(\"el-button\",{attrs:{icon:\"el-icon-search\",type:\"primary\",plain:\"\"},on:{click:e.fetchNewList}})],1),a(\"el-table\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:e.loading,expression:\"loading\"}],staticStyle:{width:\"100%\"},attrs:{data:e.tableData}},[a(\"el-table-column\",{attrs:{label:\"ID\",prop:\"id\",width:\"180\"}}),a(\"el-table-column\",{attrs:{label:\"标题\",prop:\"title\"}}),a(\"el-table-column\",{attrs:{label:\"状态\",width:\"180\"},scopedSlots:e._u([{key:\"default\",fn:function(t){return[a(\"span\",{staticClass:\"text-button\",class:[0==t.row.defunct?\"text-button--success\":\"text-button--danger\"]},[e._v(e._s(0==t.row.defunct?\"显示\":\"隐藏\"))]),t.row.top>0?a(\"span\",{staticClass:\"text-button text-button--success\"},[e._v(\"置顶\")]):e._e()]}}])}),a(\"el-table-column\",{attrs:{label:\"操作\",width:\"300\"},scopedSlots:e._u([{key:\"default\",fn:function(t){return[a(\"el-button\",{attrs:{size:\"mini\",type:\"primary\"},on:{click:function(a){return e.$router.push({name:\"adminEditNew\",params:{id:t.row.id}})}}},[e._v(\"编辑\")]),a(\"el-button\",{attrs:{size:\"mini\",type:0==t.row.defunct?\"danger\":\"success\"},on:{click:function(a){return e.handleToggleNewStatus(t.row)}}},[e._v(e._s(0==t.row.defunct?\"隐藏\":\"显示\"))]),a(\"el-button\",{attrs:{size:\"mini\",type:0==t.row.top?\"success\":\"danger\"},on:{click:function(a){return e.handleToggleNewTopStatus(t.row)}}},[e._v(e._s(0==t.row.top?\"置顶\":\"取置\"))]),a(\"el-button\",{attrs:{size:\"mini\",type:\"danger\"},on:{click:function(a){return e.handleDeleteNew(t.row)}}},[e._v(\"删除\")])]}}])}),a(\"div\",{staticClass:\"content__pagination__wrapper\"})],1),a(\"el-pagination\",{attrs:{\"current-page\":e.currentPage,\"page-sizes\":[10,20,30,40,50],\"page-size\":10,layout:\"total, sizes, prev, pager, next, jumper\",total:e.total},on:{\"size-change\":e.handleSizeChange,\"current-change\":e.fetchNewList,\"update:currentPage\":function(t){e.currentPage=t},\"update:current-page\":function(t){e.currentPage=t}}})],1)])},[],!1,null,\"1b0404ed\",null);t.default=c.exports},57:function(e,t,a){\"use strict\";a.d(t,\"a\",function(){return s}),a.d(t,\"c\",function(){return r}),a.d(t,\"d\",function(){return c}),a.d(t,\"e\",function(){return i}),a.d(t,\"b\",function(){return o}),a.d(t,\"f\",function(){return u}),a.d(t,\"g\",function(){return l});var n=a(0);function s(e){return Object(n.a)(\"POST\",\"admin/new\",e)}function r(e,t){return console.log(e,t),Object(n.a)(\"PUT\",`admin/new/${e}`,t)}function c(e){return Object(n.a)(\"GET\",`admin/new/${e}`)}function i(e,t,a){return Object(n.a)(\"GET\",\"admin/news\",{page:e,perpage:t,param:a})}function o(e){return Object(n.a)(\"DELETE\",`admin/new/${e}`)}function u(e){return Object(n.a)(\"PUT\",`admin/new/${e}/status`)}function l(e){return Object(n.a)(\"PUT\",`admin/new/${e}/topstatus`)}}}]);","extractedComments":[]}