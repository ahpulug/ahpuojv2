{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{13:function(t,e,n){\"use strict\";n.d(e,\"e\",function(){return r}),n.d(e,\"j\",function(){return i}),n.d(e,\"l\",function(){return o}),n.d(e,\"m\",function(){return s}),n.d(e,\"k\",function(){return c}),n.d(e,\"f\",function(){return l}),n.d(e,\"p\",function(){return m}),n.d(e,\"o\",function(){return u}),n.d(e,\"d\",function(){return d}),n.d(e,\"i\",function(){return f}),n.d(e,\"n\",function(){return p}),n.d(e,\"a\",function(){return g}),n.d(e,\"g\",function(){return b}),n.d(e,\"c\",function(){return h}),n.d(e,\"b\",function(){return y}),n.d(e,\"h\",function(){return v});var a=n(0);function r(t){return Object(a.a)(\"POST\",\"admin/contest\",t)}function i(t,e){return console.log(t,e),Object(a.a)(\"PUT\",`admin/contest/${t}`,e)}function o(t){return Object(a.a)(\"GET\",`admin/contest/${t}`)}function s(t,e,n){return Object(a.a)(\"GET\",\"admin/contests\",{page:t,perpage:e,param:n})}function c(){return Object(a.a)(\"GET\",\"admin/allcontests\")}function l(t){return Object(a.a)(\"DELETE\",`admin/contest/${t}`)}function m(t){return Object(a.a)(\"PUT\",`admin/contest/${t}/status`)}function u(t,e,n,r){return Object(a.a)(\"GET\",`admin/contest/${t}/users`,{page:e,perpage:n,param:r})}function d(t,e){return Object(a.a)(\"POST\",`admin/contest/${t}/users`,e)}function f(t,e){return Object(a.a)(\"DELETE\",`admin/contest/${t}/user/${e}`)}function p(t){return Object(a.a)(\"GET\",`admin/contest/${t}/teams`)}function g(t,e){return Object(a.a)(\"POST\",`admin/contest/${t}/team/${e}`)}function b(t,e){return Object(a.a)(\"DELETE\",`admin/contest/${t}/team/${e}`)}function h(t,e,n){return Object(a.a)(\"POST\",`admin/contest/${t}/team/${e}/users`,n)}function y(t,e){return Object(a.a)(\"POST\",`admin/contest/${t}/team/${e}/allusers`)}function v(t,e,n){return Object(a.a)(\"DELETE\",`admin/contest/${t}/team/${e}/user/${n}`)}},369:function(t,e,n){\"use strict\";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n(\"div\",{staticClass:\"admin-content\"},[n(\"div\",{staticClass:\"content__breadcrumb\"},[n(\"el-breadcrumb\",{attrs:{separator:\"/\"}},[n(\"el-breadcrumb-item\",{attrs:{to:{name:\"adminIndex\"}}},[t._v(\"首页\")]),n(\"el-breadcrumb-item\",[t._v(t._s(t.$route.meta.title))])],1)],1),n(\"div\",{staticClass:\"content__main\"},[n(\"el-form\",{ref:\"form\",attrs:{model:t.form,rules:t.rules,\"label-width\":\"6em\"}},[n(\"el-form-item\",{attrs:{label:\"名称\",prop:\"name\"}},[n(\"el-input\",{attrs:{placeholder:\"请输入名称\",autofocus:!0},model:{value:t.form.name,callback:function(e){t.$set(t.form,\"name\",e)},expression:\"form.name\"}})],1),n(\"el-form-item\",{attrs:{label:\"开始时间\",prop:\"start_time\"}},[n(\"el-date-picker\",{staticStyle:{width:\"100%\"},attrs:{type:\"datetime\",format:\"yyyy-MM-dd HH:mm:ss\",\"value-format\":\"yyyy-MM-dd HH:mm:ss\",placeholder:\"选择开始时间\"},model:{value:t.form.start_time,callback:function(e){t.$set(t.form,\"start_time\",e)},expression:\"form.start_time\"}})],1),n(\"el-form-item\",{attrs:{label:\"结束时间\",prop:\"end_time\"}},[n(\"el-date-picker\",{staticStyle:{width:\"100%\"},attrs:{type:\"datetime\",format:\"yyyy-MM-dd HH:mm:ss\",\"value-format\":\"yyyy-MM-dd HH:mm:ss\",placeholder:\"选择结束时间\"},model:{value:t.form.end_time,callback:function(e){t.$set(t.form,\"end_time\",e)},expression:\"form.end_time\"}})],1),n(\"el-form-item\",{attrs:{label:\"题目编号\"}},[n(\"el-input\",{attrs:{placeholder:\"使用 , 半角逗号 分隔题目ID列表，格式如:1000,1001,1002\",autofocus:!0},model:{value:t.form.problems,callback:function(e){t.$set(t.form,\"problems\",e)},expression:\"form.problems\"}})],1),n(\"el-form-item\",{attrs:{label:\"简介\"}},[n(\"tinymce-editor\",{attrs:{height:300},model:{value:t.form.description,callback:function(e){t.$set(t.form,\"description\",e)},expression:\"form.description\"}})],1),n(\"el-form-item\",{attrs:{label:\"公开度\"}},[n(\"el-switch\",{attrs:{\"active-text\":\"私有\",\"inactive-text\":\"公开\",\"inactive-color\":\"#99cc33\",\"active-value\":1,\"inactive-value\":0},model:{value:t.form.private,callback:function(e){t.$set(t.form,\"private\",e)},expression:\"form.private\"}})],1),n(\"el-form-item\",{attrs:{label:\"团队模式\"}},[n(\"el-switch\",{attrs:{\"active-text\":\"团队\",\"inactive-text\":\"个人\",\"inactive-color\":\"#99cc33\",\"active-value\":1,\"inactive-value\":0},on:{change:t.notifyModeChange},model:{value:t.form.team_mode,callback:function(e){t.$set(t.form,\"team_mode\",e)},expression:\"form.team_mode\"}})],1),n(\"el-form-item\",{attrs:{label:\"语言\"}},[n(\"el-checkbox-group\",{on:{change:t.calcMask},model:{value:t.selectedLangList,callback:function(e){t.selectedLangList=e},expression:\"selectedLangList\"}},t._l(t.langList,function(e,a){return n(\"el-checkbox\",{key:e.name,attrs:{label:e.name,disabled:!e.available,checked:(t.form.langmask&1<<a)>0}})}),1)],1),n(\"el-form-item\",{staticClass:\"fl\"},[n(\"el-button\",{attrs:{type:\"primary\"},on:{click:t.submit}},[t._v(\"提交\")])],1)],1)],1)])};a._withStripped=!0;var r=n(42),i=n(13),o=n(6),s={components:{TinymceEditor:r.a},data(){return{langList:[],selectedLangList:[],form:{name:\"\",start_time:\"\",end_time:\"\",problems:\"\",description:\"\",langmask:0,private:0,team_mode:0},rules:{name:[{required:!0,message:\"请输入问题名称\",trigger:\"blur\"},{max:20,message:\"超出长度限制\",trigger:\"blur\"}],start_time:[{validator:(t,e,n)=>{if(\"\"===e)n(new Error(\"请输入开始时间\"));else if(\"\"!=this.form.end_time){let t=new Date(this.form.start_time),e=new Date(this.form.end_time);t.getTime()<e.getTime()?(this.$refs.form.validateField(\"end_time\"),n()):n()}else n()},trigger:\"blur\"}],end_time:[{validator:(t,e,n)=>{if(\"\"===e)n(new Error(\"请输入结束时间\"));else if(\"\"!=this.form.start_time){let t=new Date(this.form.start_time),e=new Date(this.form.end_time);t.getTime()<e.getTime()?n():n(new Error(\"结束必须大于开始时间\"))}else n()},trigger:\"blur\"}]}}},async mounted(){let t=await Object(o.i)();this.langList=t.data.languages,this.init()},methods:{async init(){const t=this;if(\"adminEditContest\"==t.$route.name)try{let e=t.$route.params.id,n=await Object(i.l)(e);t.form=n.data.contest,this.$notify({title:\"提示\",message:\"更改公开度与团队模式后私有比赛的参赛人员需要重新进行设置！\",duration:6e3});for(let e in t.langList)t.langList[e].available&&t.form.langmask&1<<e&&t.selectedLangList.push(t.langList[e].name)}catch(e){console.log(e),t.$router.replace({name:\"admin404Page\"})}else Object.assign(t.form,{name:\"\",start_time:\"\",end_time:\"\",problems:\"\",description:\"\",langmask:0,private:0,team_mode:0});for(let t in this.langList)this.langList[t].available&&(this.form.langmask=this.form.langmask|1<<t)},async submit(){const t=this;t.$refs.form.validate(async e=>{if(!e)return t.$message({message:\"表单必填项不能为空\",type:\"error\"}),!1;try{let e;if(\"adminAddContest\"==t.$route.name)e=await Object(i.e)(t.form);else{let n=t.$route.params.id;e=await Object(i.j)(n,t.form)}t.$message({message:e.data.message,type:\"success\"}),t.$router.push({name:\"adminContestList\"})}catch(e){t.$message({message:e.response.data.message,type:\"error\"})}})},calcMask(t){let e=0;for(let t=0;t<this.selectedLangList.length;t++)for(let n=0;n<this.langList.length;n++)this.selectedLangList[t]==this.langList[n].name&&(e|=1<<n);this.form.langmask=e},notifyModeChange(){1==this.form.team_mode&&this.$notify({title:\"提示\",message:\"团队模式只能为私有\",duration:6e3})}},computed:{private(){return this.form.private},teamMode(){return this.form.team_mode}},watch:{$route(t,e){\"adminAddContest\"!=t.name&&\"adminEditContest\"!=t.name||this.init()},private(t,e){0==t&&(this.form.team_mode=0)},teamMode(t,e){1==t&&(this.form.private=1)}}},c=n(2),l=Object(c.a)(s,a,[],!1,null,\"1dc15426\",null);l.options.__file=\"web-admin/js/pages/contest/index.vue\";e.default=l.exports},42:function(t,e,n){\"use strict\";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n(\"div\",{staticClass:\"tinymce-editor\",style:{height:t.height+\"px\"}},[n(\"editor\",{attrs:{init:t.init,disabled:t.disabled},on:{onClick:t.onClick},model:{value:t.myValue,callback:function(e){t.myValue=e},expression:\"myValue\"}})],1)};a._withStripped=!0;var r=n(101),i=n.n(r),o=n(102),s=(n(173),n(174),n(175),n(176),n(177),n(178),n(179),n(180),n(181),n(26)),c=n(37),l=n.n(c),m={name:\"tinymce-editor\",components:{Editor:o.a},props:{value:{type:String,default:\"\"},disabled:{type:Boolean,default:!1},plugins:{type:[String,Array],default:\"lists image table wordcount code\"},toolbar:{type:[String,Array],default:\"undo redo |  formatselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | code image  table | removeformat\"},height:{type:Number,default:600}},data(){return{init:{relative_urls:!0,document_base_url:s.c,language_url:\"/static/tinymce/langs/zh_CN.js\",skin_url:\"/static/tinymce/skins/ui/oxide\",content_css:\"/static/tinymce/skins/ui/oxide/content.min.css\",language:\"zh_CN\",height:this.height,resize:!1,plugins:this.plugins,toolbar:this.toolbar,branding:!1,menubar:!1,automatic_uploads:!1,images_upload_handler:(t,e,n)=>{let a;(a=new FormData).append(\"file\",t.blob(),t.filename());l.a.post(\"/api/admin/image\",a,{headers:{\"Content-Type\":\"multipart/form-data\",Authorization:\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE1NjAzNjg1NDQsInVzZXIiOiJhZG1pbiJ9.7K5BCDoodn10AH4Gwe_yDUDBSLWXnG-ogVFoGycQ7WU\"}}).then(t=>{e(t.data.url)}).catch(t=>{})}},myValue:this.value}},mounted(){},methods:{onClick(t){this.$emit(\"onClick\",t,i.a)},clear(){this.myValue=\"\"}},watch:{value(t){this.myValue=t},myValue(t){this.$emit(\"input\",t)}}},u=n(2),d=Object(u.a)(m,a,[],!1,null,\"393b9879\",null);d.options.__file=\"web-common/components/tinymce_editor.vue\";e.a=d.exports},6:function(t,e,n){\"use strict\";n.d(e,\"i\",function(){return r}),n.d(e,\"m\",function(){return i}),n.d(e,\"j\",function(){return o}),n.d(e,\"h\",function(){return s}),n.d(e,\"g\",function(){return c}),n.d(e,\"k\",function(){return l}),n.d(e,\"l\",function(){return m}),n.d(e,\"n\",function(){return u}),n.d(e,\"o\",function(){return d}),n.d(e,\"c\",function(){return f}),n.d(e,\"b\",function(){return p}),n.d(e,\"e\",function(){return g}),n.d(e,\"f\",function(){return b}),n.d(e,\"d\",function(){return h}),n.d(e,\"a\",function(){return y});var a=n(0);function r(){return Object(a.a)(\"GET\",\"languages\")}function i(t,e){return Object(a.a)(\"GET\",\"ranklist\",{page:t,perpage:e})}function o(t,e){return Object(a.a)(\"GET\",\"news\",{page:t,perpage:e})}function s(t,e,n){return Object(a.a)(\"GET\",`problem/${t}/issues`,{page:e,perpage:n})}function c(t,e,n){return Object(a.a)(\"GET\",`/issue/${t}`,{page:e,perpage:n})}function l(t){return Object(a.a)(\"GET\",`problem/${t}`)}function m(t,e,n,r,i){return Object(a.a)(\"GET\",\"problems\",{page:t,perpage:e,param:n,level:r,tag_id:i})}function u(t){return Object(a.a)(\"GET\",`solution/${t}`)}function d(t,e,n,r,i,o,s){return Object(a.a)(\"GET\",\"solutions\",{page:t,perpage:e,param:n,username:r,language:i,result:o,contest_id:s})}function f(t,e,n){return Object(a.a)(\"GET\",\"contests\",{page:t,perpage:e,param:n})}function p(t){return Object(a.a)(\"GET\",`contest/${t}`)}function g(t){return Object(a.a)(\"GET\",`contest/${t}/ranklist`)}function b(t){return Object(a.a)(\"GET\",`contest/${t}/teamranklist`)}function h(t,e){return Object(a.a)(\"GET\",`contest/${t}/problem/${e}`)}function y(){return Object(a.a)(\"GET\",\"alltags\")}}}]);","extractedComments":[]}