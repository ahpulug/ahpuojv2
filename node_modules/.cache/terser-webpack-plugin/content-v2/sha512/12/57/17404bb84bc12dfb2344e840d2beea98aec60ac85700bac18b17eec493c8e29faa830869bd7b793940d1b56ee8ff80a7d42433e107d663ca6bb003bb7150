{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{13:function(t,e,n){\"use strict\";n.d(e,\"e\",function(){return r}),n.d(e,\"j\",function(){return s}),n.d(e,\"l\",function(){return i}),n.d(e,\"m\",function(){return o}),n.d(e,\"k\",function(){return c}),n.d(e,\"f\",function(){return l}),n.d(e,\"p\",function(){return u}),n.d(e,\"o\",function(){return d}),n.d(e,\"d\",function(){return m}),n.d(e,\"i\",function(){return f}),n.d(e,\"n\",function(){return p}),n.d(e,\"a\",function(){return g}),n.d(e,\"g\",function(){return b}),n.d(e,\"c\",function(){return h}),n.d(e,\"b\",function(){return $}),n.d(e,\"h\",function(){return _});var a=n(0);function r(t){return Object(a.a)(\"POST\",\"admin/contest\",t)}function s(t,e){return console.log(t,e),Object(a.a)(\"PUT\",`admin/contest/${t}`,e)}function i(t){return Object(a.a)(\"GET\",`admin/contest/${t}`)}function o(t,e,n){return Object(a.a)(\"GET\",\"admin/contests\",{page:t,perpage:e,param:n})}function c(){return Object(a.a)(\"GET\",\"admin/allcontests\")}function l(t){return Object(a.a)(\"DELETE\",`admin/contest/${t}`)}function u(t){return Object(a.a)(\"PUT\",`admin/contest/${t}/status`)}function d(t,e,n,r){return Object(a.a)(\"GET\",`admin/contest/${t}/users`,{page:e,perpage:n,param:r})}function m(t,e){return Object(a.a)(\"POST\",`admin/contest/${t}/users`,e)}function f(t,e){return Object(a.a)(\"DELETE\",`admin/contest/${t}/user/${e}`)}function p(t){return Object(a.a)(\"GET\",`admin/contest/${t}/teams`)}function g(t,e){return Object(a.a)(\"POST\",`admin/contest/${t}/team/${e}`)}function b(t,e){return Object(a.a)(\"DELETE\",`admin/contest/${t}/team/${e}`)}function h(t,e,n){return Object(a.a)(\"POST\",`admin/contest/${t}/team/${e}/users`,n)}function $(t,e){return Object(a.a)(\"POST\",`admin/contest/${t}/team/${e}/allusers`)}function _(t,e,n){return Object(a.a)(\"DELETE\",`admin/contest/${t}/team/${e}/user/${n}`)}},569:function(t,e,n){\"use strict\";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n(\"div\",{staticClass:\"admin-content\"},[n(\"div\",{staticClass:\"content__breadcrumb\"},[n(\"el-breadcrumb\",{attrs:{separator:\"/\"}},[n(\"el-breadcrumb-item\",{attrs:{to:{name:\"adminIndex\"}}},[t._v(\"首页\")]),n(\"el-breadcrumb-item\",[t._v(t._s(t.$route.meta.title))])],1)],1),n(\"div\",{staticClass:\"content__main\"},[n(\"el-card\",{staticClass:\"content__card__wrapper\"},[n(\"p\",[t._v(\"竞赛&作业名称: \"+t._s(t.contest.name))]),n(\"p\",[t._v(\"人员总数: \"+t._s(t.total))])]),n(\"div\",{staticClass:\"content__button__wrapper\"},[n(\"el-button\",{attrs:{type:\"success\"},on:{click:t.handleAddUser}},[t._v(\"添加人员\")])],1),n(\"div\",{staticClass:\"content__searchbar__wrapper\"},[n(\"el-input\",{staticStyle:{\"max-width\":\"20em\"},attrs:{placeholder:\"请输入用户名或昵称\",maxlength:\"20\",clearable:\"\"},model:{value:t.queryParam,callback:function(e){t.queryParam=e},expression:\"queryParam\"}}),n(\"el-button\",{attrs:{icon:\"el-icon-search\",type:\"primary\",plain:\"\"},on:{click:t.fetchContestUserList}})],1),n(\"el-table\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:t.loading,expression:\"loading\"}],staticStyle:{width:\"100%\"},attrs:{data:t.tableData}},[n(\"el-table-column\",{attrs:{label:\"ID\",prop:\"id\",width:\"180\"}}),n(\"el-table-column\",{attrs:{label:\"用户名\",prop:\"username\",width:\"180\"}}),n(\"el-table-column\",{attrs:{label:\"昵称\",prop:\"nick\"}}),n(\"el-table-column\",{attrs:{label:\"操作\",width:\"180\"},scopedSlots:t._u([{key:\"default\",fn:function(e){return[n(\"el-button\",{attrs:{size:\"mini\",type:\"danger\"},on:{click:function(n){return t.handleDeleteContestUser(e.row)}}},[t._v(\"删除\")])]}}])})],1),n(\"el-pagination\",{attrs:{\"current-page\":t.currentPage,\"page-sizes\":[10,20,30,40,50],\"page-size\":10,layout:\"total, sizes, prev, pager, next, jumper\",total:t.total},on:{\"size-change\":t.handleSizeChange,\"current-change\":t.fetchContestUserList,\"update:currentPage\":function(e){t.currentPage=e},\"update:current-page\":function(e){t.currentPage=e}}}),n(\"el-dialog\",{attrs:{title:\"添加竞赛&作业成员\",visible:t.dialogFormVisible,width:\"400px\",\"close-on-click-modal\":!1},on:{\"update:visible\":function(e){t.dialogFormVisible=e},closed:t.closeDialog,opened:t.openDialog}},[n(\"el-form\",{ref:\"form\",attrs:{model:t.form,rules:t.rules},nativeOn:{submit:function(t){t.preventDefault()}}},[n(\"el-form-item\",{attrs:{label:\"用户名列表\",prop:\"userList\"}},[n(\"el-input\",{ref:\"input\",attrs:{type:\"textarea\",rows:\"20\",autocomplete:\"off\",resize:\"none\"},model:{value:t.form.userList,callback:function(e){t.$set(t.form,\"userList\",e)},expression:\"form.userList\"}})],1)],1),n(\"div\",{staticClass:\"dialog-footer\",attrs:{slot:\"footer\"},slot:\"footer\"},[n(\"el-button\",{on:{click:t.cancel}},[t._v(\"取消\")]),n(\"el-button\",{attrs:{type:\"primary\",\"native-type\":\"submit\"},on:{click:t.submit}},[t._v(\"确定\")])],1)],1),n(\"el-dialog\",{attrs:{title:\"操作信息\",visible:t.dialogOperatorInfoVisible,\"close-on-click-modal\":!1,width:\"600px\"},on:{\"update:visible\":function(e){t.dialogOperatorInfoVisible=e}}},[t._l(t.infoList,function(e,a){return[n(\"p\",{key:a},[t._v(t._s(e))])]}),n(\"div\",{staticClass:\"dialog-footer\",attrs:{slot:\"footer\"},slot:\"footer\"},[n(\"el-button\",{on:{click:function(e){t.dialogOperatorInfoVisible=!1}}},[t._v(\"取消\")]),n(\"el-button\",{attrs:{type:\"primary\"},on:{click:function(e){t.dialogOperatorInfoVisible=!1}}},[t._v(\"确定\")])],1)],2)],1)])};a._withStripped=!0;var r=n(13),s={data:()=>({loading:!0,currentPage:1,currentRowId:0,perpage:10,queryParam:\"\",total:0,dialogFormVisible:!1,dialogOperatorInfoVisible:!1,infoList:[],contest:{},form:{userList:\"\"},rules:{userList:[{required:!0,message:\"请输入要添加的用户名列表\",trigger:\"blur\"}]},tableData:[]}),async mounted(){let t=this.$route.params.id;try{let e=await Object(r.l)(t);this.contest=e.data.contest,this.fetchContestUserList()}catch(t){this.$router.replace({name:\"admin404Page\"}),console.log(t)}},methods:{async fetchContestUserList(){const t=this;t.loading=!0;try{let e=await Object(r.o)(t.contest.id,t.currentPage,t.perpage,t.queryParam);console.log(e);let n=e.data;setTimeout(()=>{t.tableData=n.data,t.total=n.total,t.loading=!1},200)}catch(t){console.log(t)}},handleSizeChange(t){this.perpage=t,console.log(this.perpage),this.fetchContestUserList()},openDialog(){this.$notify({title:\"提示\",message:\"每一行对应一个用户名，若对应账号存在则加入团队，否则将忽略。\",duration:6e3}),this.$refs.form.clearValidate(),this.$refs.input.focus()},closeDialog(){this.$refs.form.resetFields(),this.$refs.input.blur()},submit(){const t=this;t.$refs.form.validate(async e=>{if(!e)return!1;try{let e,n=t.$route.params.id;e=await Object(r.d)(n,t.form),t.infoList=e.data.info,t.dialogOperatorInfoVisible=!0,t.$message({message:e.data.message,type:\"success\"}),t.fetchContestUserList()}catch(e){t.$message({message:e.response.data.message,type:\"error\"})}t.dialogFormVisible=!1})},cancel(){this.dialogFormVisible=!1},handleAddUser(){this.dialogFormVisible=!0},async handleDeleteContestUser(t){const e=this;try{await e.$confirm(`确认要删除团队成员${t.username}吗?`,\"提示\",{confirmButtonText:\"确定\",cancelButtonText:\"取消\",type:\"warning\"});try{let n=await Object(r.i)(e.contest.id,t.id);e.$message({type:\"success\",message:n.data.message}),1==e.tableData.length&&e.currentPage>1&&e.currentPage--,e.fetchContestUserList()}catch(t){e.$message({type:\"error\",message:t.response.data.message})}}catch(t){e.$message({type:\"info\",message:\"已取消删除\"})}}}},i=n(2),o=Object(i.a)(s,a,[],!1,null,\"469fcd8d\",null);o.options.__file=\"web-admin/js/pages/contest_manage/index.vue\";e.default=o.exports}}]);","extractedComments":[]}