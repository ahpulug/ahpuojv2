{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{13:function(t,e,n){\"use strict\";n.d(e,\"e\",function(){return r}),n.d(e,\"j\",function(){return s}),n.d(e,\"l\",function(){return i}),n.d(e,\"m\",function(){return o}),n.d(e,\"k\",function(){return c}),n.d(e,\"f\",function(){return u}),n.d(e,\"p\",function(){return l}),n.d(e,\"o\",function(){return d}),n.d(e,\"d\",function(){return m}),n.d(e,\"i\",function(){return f}),n.d(e,\"n\",function(){return p}),n.d(e,\"a\",function(){return b}),n.d(e,\"g\",function(){return g}),n.d(e,\"c\",function(){return h}),n.d(e,\"b\",function(){return _}),n.d(e,\"h\",function(){return $});var a=n(0);function r(t){return Object(a.a)(\"POST\",\"admin/contest\",t)}function s(t,e){return console.log(t,e),Object(a.a)(\"PUT\",`admin/contest/${t}`,e)}function i(t){return Object(a.a)(\"GET\",`admin/contest/${t}`)}function o(t,e,n){return Object(a.a)(\"GET\",\"admin/contests\",{page:t,perpage:e,param:n})}function c(){return Object(a.a)(\"GET\",\"admin/allcontests\")}function u(t){return Object(a.a)(\"DELETE\",`admin/contest/${t}`)}function l(t){return Object(a.a)(\"PUT\",`admin/contest/${t}/status`)}function d(t,e,n,r){return Object(a.a)(\"GET\",`admin/contest/${t}/users`,{page:e,perpage:n,param:r})}function m(t,e){return Object(a.a)(\"POST\",`admin/contest/${t}/users`,e)}function f(t,e){return Object(a.a)(\"DELETE\",`admin/contest/${t}/user/${e}`)}function p(t){return Object(a.a)(\"GET\",`admin/contest/${t}/teams`)}function b(t,e){return Object(a.a)(\"POST\",`admin/contest/${t}/team/${e}`)}function g(t,e){return Object(a.a)(\"DELETE\",`admin/contest/${t}/team/${e}`)}function h(t,e,n){return Object(a.a)(\"POST\",`admin/contest/${t}/team/${e}/users`,n)}function _(t,e){return Object(a.a)(\"POST\",`admin/contest/${t}/team/${e}/allusers`)}function $(t,e,n){return Object(a.a)(\"DELETE\",`admin/contest/${t}/team/${e}/user/${n}`)}},48:function(t,e,n){\"use strict\";n.d(e,\"b\",function(){return r}),n.d(e,\"d\",function(){return s}),n.d(e,\"e\",function(){return i}),n.d(e,\"g\",function(){return o}),n.d(e,\"f\",function(){return c}),n.d(e,\"h\",function(){return u}),n.d(e,\"a\",function(){return l}),n.d(e,\"c\",function(){return d});var a=n(0);function r(t){return Object(a.a)(\"POST\",\"admin/series\",t)}function s(t,e){return Object(a.a)(\"PUT\",`admin/series/${t}`,e)}function i(t){return Object(a.a)(\"GET\",`admin/series/${t}`)}function o(t,e,n){return Object(a.a)(\"GET\",\"admin/serieses\",{page:t,perpage:e,param:n})}function c(t,e,n,r){return Object(a.a)(\"GET\",`admin/series/${t}/contests`,{page:e,perpage:n,param:r})}function u(t){return Object(a.a)(\"PUT\",`admin/series/${t}/status`)}function l(t,e){return Object(a.a)(\"POST\",`admin/series/${t}/contest/${e}`)}function d(t,e){return Object(a.a)(\"DELETE\",`admin/series/${t}/contest/${e}`)}},573:function(t,e,n){\"use strict\";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n(\"div\",{staticClass:\"admin-content\"},[n(\"div\",{staticClass:\"content__breadcrumb\"},[n(\"el-breadcrumb\",{attrs:{separator:\"/\"}},[n(\"el-breadcrumb-item\",{attrs:{to:{name:\"adminIndex\"}}},[t._v(\"首页\")]),n(\"el-breadcrumb-item\",[t._v(t._s(t.$route.meta.title))])],1)],1),n(\"div\",{staticClass:\"content__main\"},[n(\"div\",{staticClass:\"content__searchbar__wrapper\"},[n(\"el-card\",{staticClass:\"content__card__wrapper\"},[n(\"p\",[t._v(\"系列赛名称: \"+t._s(t.series.name))]),n(\"p\",[t._v(\"包含竞赛&作业总数: \"+t._s(t.tableData.length))])])],1),n(\"div\",{staticClass:\"content__button__wrapper\"},[n(\"el-button\",{attrs:{type:\"success\"},on:{click:t.handleAddUser}},[t._v(\"添加竞赛&作业\")])],1),n(\"div\",{staticClass:\"content__searchbar__wrapper\"},[n(\"el-input\",{staticStyle:{\"max-width\":\"20em\"},attrs:{placeholder:\"请输入竞赛&作业名称\",maxlength:\"20\",clearable:\"\"},model:{value:t.queryParam,callback:function(e){t.queryParam=e},expression:\"queryParam\"}}),n(\"el-button\",{attrs:{icon:\"el-icon-search\",type:\"primary\",plain:\"\"},on:{click:t.fetchSeriesContestList}})],1),n(\"el-table\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:t.loading,expression:\"loading\"}],staticStyle:{width:\"100%\"},attrs:{data:t.tableData}},[n(\"el-table-column\",{attrs:{label:\"ID\",prop:\"id\",width:\"180\"}}),n(\"el-table-column\",{attrs:{label:\"名称\",prop:\"name\",width:\"180\"}}),n(\"el-table-column\",{attrs:{label:\"模式\",\"min-width\":\"150\"},scopedSlots:t._u([{key:\"default\",fn:function(e){return[n(\"span\",{class:[\"text-button\",0==e.row.private?\"text-button--danger\":\"text-button--success\"]},[t._v(t._s(0==e.row.private?\"私有赛\":\"公开赛\"))]),n(\"span\",{class:[\"text-button\",0==e.row.team_mode?\"text-button--success\":\"text-button--primary\"]},[t._v(t._s(0==e.row.team_mode?\"个人赛\":\"团体赛\"))])]}}])}),n(\"el-table-column\",{attrs:{label:\"操作\",width:\"180\"},scopedSlots:t._u([{key:\"default\",fn:function(e){return[n(\"el-button\",{attrs:{size:\"mini\",type:\"danger\"},on:{click:function(n){return t.handleDeleteSeriesContest(e.row)}}},[t._v(\"删除\")])]}}])})],1),n(\"el-pagination\",{attrs:{\"current-page\":t.currentPage,\"page-sizes\":[10,20,30,40,50],\"page-size\":10,layout:\"total, sizes, prev, pager, next, jumper\",total:t.total},on:{\"size-change\":t.handleSizeChange,\"current-change\":t.fetchSeriesContestList,\"update:currentPage\":function(e){t.currentPage=e},\"update:current-page\":function(e){t.currentPage=e}}}),n(\"el-dialog\",{attrs:{title:\"添加竞赛&作业\",visible:t.dialogFormVisible,width:\"400px\",\"close-on-click-modal\":!1},on:{\"update:visible\":function(e){t.dialogFormVisible=e},closed:t.closeDialog,opened:t.openDialog}},[n(\"el-form\",{ref:\"form\",attrs:{model:t.form,rules:t.rules},nativeOn:{submit:function(t){t.preventDefault()}}},[n(\"el-form-item\",{attrs:{label:\"选择竞赛&作业\",prop:\"contest_id\"}},[n(\"el-select\",{attrs:{filterable:\"\",placeholder:\"请选择\"},model:{value:t.form.contest_id,callback:function(e){t.$set(t.form,\"contest_id\",e)},expression:\"form.contest_id\"}},t._l(t.contests,function(t){return n(\"el-option\",{key:t.id,attrs:{label:t.name,value:t.id}})}),1)],1)],1),n(\"div\",{staticClass:\"dialog-footer\",attrs:{slot:\"footer\"},slot:\"footer\"},[n(\"el-button\",{on:{click:t.cancel}},[t._v(\"取消\")]),n(\"el-button\",{attrs:{type:\"primary\",\"native-type\":\"submit\"},on:{click:t.submit}},[t._v(\"确定\")])],1)],1)],1)])};a._withStripped=!0;var r=n(48),s=n(13),i={data:()=>({loading:!0,currentPage:1,currentRowId:0,perpage:10,queryParam:\"\",total:0,dialogFormVisible:!1,series:{},contests:[],form:{contest_id:null},rules:{contest_id:[{required:!0,message:\"请输入要添加的用户名列表\",trigger:\"change\"}]},tableData:[]}),async mounted(){let t=this.$route.params.id;try{let e=await Object(r.e)(t);this.series=e.data.series,this.fetchSeriesContestList(),e=await Object(s.k)(),this.contests=e.data.contests}catch(t){this.$router.replace({name:\"admin404Page\"}),console.log(t)}},methods:{async fetchSeriesContestList(){const t=this;t.loading=!0;try{let e=await Object(r.f)(t.series.id,t.currentPage,t.perpage,t.queryParam);console.log(e);let n=e.data;setTimeout(()=>{t.tableData=n.data,t.total=n.total,t.loading=!1},200)}catch(t){console.log(t)}},handleSizeChange(t){this.perpage=t,console.log(this.perpage),this.fetchSeriesContestList()},openDialog(){this.$notify({title:\"提示\",message:\"每一行对应一个竞赛&作业ID，若对应竞赛&作业存在则加入系列赛，否则将忽略。\",duration:6e3}),this.$refs.form.clearValidate()},closeDialog(){this.$refs.form.resetFields()},submit(){const t=this;t.$refs.form.validate(async e=>{if(!e)return!1;try{let e,n=t.$route.params.id;e=await Object(r.a)(n,t.form.contest_id),console.log(e),t.$message({message:e.data.message,type:\"success\"}),t.fetchSeriesContestList()}catch(e){console.log(e),t.$message({message:e.response.data.message,type:\"error\"})}t.dialogFormVisible=!1})},cancel(){this.dialogFormVisible=!1},handleAddUser(){this.dialogFormVisible=!0},async handleDeleteSeriesContest(t){const e=this;try{await e.$confirm(`确认要删除系列赛中的竞赛&作业${t.name}吗?`,\"提示\",{confirmButtonText:\"确定\",cancelButtonText:\"取消\",type:\"warning\"});try{let n=await Object(r.c)(e.series.id,t.id);e.$message({type:\"success\",message:n.data.message}),1==e.tableData.length&&e.currentPage>1&&e.currentPage--,e.fetchSeriesContestList()}catch(t){e.$message({type:\"error\",message:t.response.data.message})}}catch(t){e.$message({type:\"info\",message:\"已取消删除\"})}}}},o=n(2),c=Object(o.a)(i,a,[],!1,null,\"2f91f174\",null);c.options.__file=\"web-admin/js/pages/series_manage/index.vue\";e.default=c.exports}}]);","extractedComments":[]}